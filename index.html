<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#040426">
    <title>Magische Karten</title>
    <link rel="manifest" href="manifest.json">
    <link href="https://fonts.googleapis.com/css2?family=Bangers&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pixelarticons@1.8.1/fonts/pixelarticons.css" crossorigin="anonymous">

    <style>
        :root {
            --pop-red-bright: #ff0000;
            --pop-yellow: #ffd700;
            --pop-green-bright: #00ff00;
            --pop-blue-bright: #00ffff;
            --pop-black: #000000;
            --bg-dark-blue: #040426;
        }

        body {
            margin: 0; background-color: var(--bg-dark-blue);
            background-image: url('data:image/svg+xml;utf8,<svg width="60" height="60" viewBox="0 0 60 60" xmlns="http://www.w3.org/2000/svg"><circle cx="15" cy="15" r="4" fill="%234da6ff"/><circle cx="45" cy="15" r="4" fill="%23ffffff"/><circle cx="15" cy="45" r="4" fill="%23ff66b3"/><circle cx="45" cy="45" r="4" fill="%239933ff"/></svg>');
            background-size: 60px 60px; font-family: 'Bangers', cursive;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            height: 100vh; overflow: hidden;
        }

        /* Buttons & Controls */
        .controls { display: flex; gap: 12px; margin-bottom: 55px; z-index: 100; }
        .cat-btn {
            padding: 15px 22px; font-family: 'Bangers', cursive; font-size: 22px;
            border: 4px solid var(--pop-black); cursor: pointer; text-transform: uppercase;
            box-shadow: 5px 5px 0 var(--pop-black); transition: 0.1s; color: white;
            -webkit-text-stroke: 1px var(--pop-black);
        }
        #btn-drinnen.active { background: var(--pop-green-bright); }
        #btn-draussen.active { background: var(--pop-red-bright); }
        #btn-lernen.active { background: var(--pop-blue-bright); }

        /* Karte */
        .deck { position: relative; width: 280px; height: 390px; perspective: 1200px; z-index: 10; }
        .card-container { position: absolute; width: 100%; height: 100%; transform-style: preserve-3d; transition: 0.8s; }
        .card {
            position: absolute; width: 100%; height: 100%; border-radius: 15px;
            backface-visibility: hidden; display: flex; flex-direction: column;
            border: 5px solid var(--pop-black); box-shadow: 8px 8px 0px var(--pop-black); background-color: #fff;
        }
        .card-back { background-color: #0000ff; z-index: 2; }
        .card-front { transform: rotateY(180deg); z-index: 1; padding: 25px; display: flex; flex-direction: column; }

        /* Pixel-Bilder Layout */
        .card-top-half { flex: 1.2; display: flex; justify-content: center; align-items: center; }
        .card-bottom-half { flex: 1; display: flex; justify-content: center; align-items: flex-start; }
        .pixel-icon { font-size: 110px; color: var(--pop-black); line-height: 1; }
        .text-content { font-size: 34px; line-height: 1.1; text-transform: uppercase; }

        /* XXL COMIC OVERLAY */
        #comic-overlay {
            position: fixed; top: 50%; left: 50%; pointer-events: none; opacity: 0; z-index: 3000;
            font-size: 30vw; color: var(--pop-yellow); -webkit-text-stroke: 2.5vw var(--pop-black);
            text-shadow: 1.5vw 1.5vw 0 var(--pop-black); transform: translate(-50%, -50%) scale(0);
            white-space: nowrap; font-family: 'Bangers', cursive;
        }
        .comic-active { animation: comic-impact 1.2s forwards; }
        @keyframes comic-impact {
            0% { opacity: 0; transform: translate(-50%, -50%) scale(0) rotate(-35deg); }
            20% { opacity: 1; transform: translate(-50%, -50%) scale(1.6) rotate(15deg); }
            80% { opacity: 1; transform: translate(-50%, -50%) scale(1.4) rotate(10deg); }
            100% { opacity: 0; transform: translate(-50%, -50%) scale(2.2) rotate(45deg); }
        }

        #go-btn { margin-top: 40px; padding: 20px 80px; background: var(--pop-yellow); font-size: 40px; border: 5px solid var(--pop-black); cursor: pointer; box-shadow: 8px 8px 0 var(--pop-black); }
        .shuffle { animation: shuffle-move 0.4s infinite; }
        @keyframes shuffle-move { 0%, 100% { transform: translateX(0); } 50% { transform: translateX(120px) rotate(10deg); } }
        .drawn { transform: scale(1.1) translateY(-25px) rotateY(180deg) !important; z-index: 1000 !important; }
    </style>
</head>
<body>
    <div class="controls">
        <button class="cat-btn active" id="btn-drinnen" onclick="setCategory('drinnen')">Drinnen</button>
        <button class="cat-btn" id="btn-draussen" onclick="setCategory('draussen')">Draussen</button>
        <button class="cat-btn" id="btn-lernen" onclick="setCategory('lernen')">Lernen</button>
    </div>
    <div class="deck" id="deck"></div>
    <div id="comic-overlay">BOOM!</div>
    <button id="go-btn" onclick="drawCard()">GO</button>

    <script>
        // Hier folgen die Kategorien (Icons müssen exakt 'pai-' Präfix nutzen)
        const data = {
            drinnen: [{t:"Hörspiel", i:"music"}, {t:"Lego bauen", i:"widgets"}, {t:"Comic lesen", i:"book-open"}],
            draussen: [{t:"Velo", i:"bicycle"}, {t:"Wald", i:"tree"}, {t:"Tiere", i:"eye"}],
            lernen: [{t:"Mathe", i:"plus"}, {t:"Quiz", i:"help"}, {t:"Mindmap", i:"git-branch"}]
        };

        let currentCategory = 'drinnen';
        function setCategory(c) { currentCategory = c; document.querySelectorAll('.cat-btn').forEach(b => b.classList.remove('active')); document.getElementById('btn-'+c).classList.add('active'); }
        
        function createDeck() {
            const deck = document.getElementById('deck'); deck.innerHTML = '';
            for(let i=8; i>0; i--) {
                const c = document.createElement('div'); c.className = 'card-container';
                c.style.transform = `translateZ(${-i*4}px) rotate(${Math.random()*4-2}deg)`;
                c.innerHTML = '<div class="card card-back"></div><div class="card card-front"></div>';
                deck.appendChild(c);
            }
        }

        function drawCard() {
            const go = document.getElementById('go-btn'); go.disabled = true; createDeck();
            const cards = document.querySelectorAll('.card-container');
            cards.forEach((c, idx) => setTimeout(() => c.classList.add('shuffle'), idx * 50));
            setTimeout(() => {
                cards.forEach(c => c.classList.remove('shuffle'));
                const last = cards[cards.length - 1];
                const item = data[currentCategory][Math.floor(Math.random()*data[currentCategory].length)];
                last.querySelector('.card-front').innerHTML = `
                    <div class="card-top-half"><i class="pai pai-${item.i} pixel-icon"></i></div>
                    <div class="card-bottom-half"><div class="text-content">${item.t}</div></div>`;
                last.classList.add('drawn');
                if(Math.random() > 0.8) { // Nur ca. jede 6. Karte
                    const ov = document.getElementById('comic-overlay');
                    ov.classList.add('comic-active');
                    setTimeout(() => ov.classList.remove('comic-active'), 1200);
                }
                go.disabled = false;
            }, 1000);
        }
        window.onload = createDeck;
    </script>
</body>
</html>
