<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Magische Schicksalskarten</title>
    <link rel="manifest" href="manifest.json">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@700&display=swap');

        :root {
            --poker-red: #af0000;
            --poker-black: #1a1a1a;
            --gold: #c5a059;
        }

        body {
            margin: 0;
            background: radial-gradient(circle, #1a1a2e 0%, #050510 100%);
            color: #fff;
            font-family: 'Cinzel', serif;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            height: 100vh; overflow: hidden;
        }

        .deck { position: relative; width: 220px; height: 320px; perspective: 1200px; }

        .card-container {
            position: absolute; width: 100%; height: 100%;
            transform-style: preserve-3d; transition: all 0.8s cubic-bezier(0.23, 1, 0.32, 1);
        }

        .card {
            position: absolute; width: 100%; height: 100%; border-radius: 12px;
            backface-visibility: hidden; display: flex; flex-direction: column;
            align-items: center; justify-content: center; padding: 20px;
            text-align: center; box-sizing: border-box; border: 2px solid var(--gold);
        }

        /* Rückseite: Fantasy-Poker */
        .card-back {
            background: linear-gradient(135deg, #1a1a2e, #050510); z-index: 2;
            box-shadow: 0 0 20px rgba(0,0,0,0.8);
            background-image: url('data:image/svg+xml;utf8,<svg width="100" height="100" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"><path d="M50 5 L95 50 L50 95 L5 50 Z" fill="none" stroke="%23c5a059" stroke-width="2"/></svg>');
            background-size: 60px 60px;
        }

        /* Vorderseite: Pergament-Optik mit grösserem Text */
        .card-front {
            background: #e8d5b5; color: #000; transform: rotateY(180deg); z-index: 1;
            box-shadow: inset 0 0 40px rgba(0,0,0,0.2);
            font-size: 26px; /* Schriftgrösse erhöht */
            line-height: 1.2;
        }

        .suit { position: absolute; font-size: 35px; opacity: 0.9; }
        .top-left { top: 10px; left: 10px; }
        .bottom-right { bottom: 10px; right: 10px; transform: rotate(180deg); }

        /* Mischen-Animation */
        .shuffle { animation: shuffle-move 0.4s ease-in-out infinite; }
        @keyframes shuffle-move { 
            0%, 100% { transform: translateX(0); } 
            50% { transform: translateX(120px) rotate(10deg); } 
        }

        .drawn {
            transform: scale(1.35) translateY(-30px) rotateY(180deg) !important;
            z-index: 1000 !important; box-shadow: 0 0 50px rgba(0, 210, 255, 0.6);
            border: 3px solid #00d2ff !important;
        }

        button {
            margin-top: 60px; padding: 15px 50px; background: transparent;
            color: var(--gold); border: 2px solid var(--gold); font-family: 'Cinzel', serif;
            font-size: 22px; cursor: pointer; text-transform: uppercase; letter-spacing: 2px;
            transition: 0.3s;
        }
        button:active { background: var(--gold); color: #000; }
        button:disabled { opacity: 0.3; }
    </style>
</head>
<body>

    <div class="deck" id="deck"></div>
    <button id="actionBtn" onclick="drawCard()">Mischen & Ziehen</button>

    <script>
        const phrases = [
            "Hörspiel hören", "Checkersendung schauen", "Comic lesen", "Spannendes Buch lesen",
            "Rätsel lösen", "Quiz spielen", "Lego bauen", "Fantasiegeschichte erfinden",
            "Zeichnen oder malen", "Basteln mit Recyclingmaterial", "Origami falten", "Modell bauen",
            "Puzzle lösen", "Kartentrick zeigen", "Geschicklichkeitsspiel spielen", "Jonglieren üben",
            "Musik hören", "Instrument spielen", "Lied vorsingen", "Foto machen",
            "Kurzes Video drehen", "Draussen spielen", "Park oder Wald erkunden", "Tiere beobachten",
            "Pflanzen bestimmen", "Schatzsuche organisieren", "Abfall sammeln", "Müll trennen",
            "Einer Freundin anrufen", "Beim Nachbarn klingeln", "Kleinen Vortrag halten", "Etwas erklären",
            "Mini-Interview führen", "Tagebuch schreiben", "Eigene Idee umsetzen", "Kleines Projekt starten"
        ];

        const suits = [
            { s: "♠", c: "var(--poker-black)" }, { s: "♥", c: "var(--poker-red)" }, 
            { s: "♣", c: "var(--poker-black)" }, { s: "♦", c: "var(--poker-red)" }
        ];

        const deck = document.getElementById('deck');
        const btn = document.getElementById('actionBtn');

        // Geänderter Sound: Tieferer und weicherer Frequenzverlauf
        function playMagicSound() {
            try {
                const context = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = context.createOscillator();
                const gain = context.createGain();

                oscillator.type = 'triangle'; // Weicherer Klang als 'sine'
                oscillator.frequency.setValueAtTime(330, context.currentTime); // Start bei E4 (tiefer)
                oscillator.frequency.exponentialRampToValueAtTime(440, context.currentTime + 0.2); // Rampe zu A4

                gain.gain.setValueAtTime(0.1, context.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.01, context.currentTime + 0.6);

                oscillator.connect(gain);
                gain.connect(context.destination);

                oscillator.start();
                oscillator.stop(context.currentTime + 0.6);
            } catch (e) { console.log("Audio konnte nicht abgespielt werden."); }
        }

        function createDeck() {
            deck.innerHTML = '';
            for (let i = 0; i < 10; i++) {
                const container = document.createElement('div');
                container.className = 'card-container';
                container.style.transform = `translateZ(${-i * 3}px)`;
                container.innerHTML = `<div class="card card-back"></div><div class="card card-front"></div>`;
                deck.appendChild(container);
            }
        }

        function drawCard() {
            btn.disabled = true;
            createDeck();
            const cards = document.querySelectorAll('.card-container');
            
            cards.forEach((c, idx) => setTimeout(() => c.classList.add('shuffle'), idx * 30));

            setTimeout(() => {
                cards.forEach(c => c.classList.remove('shuffle'));
                
                playMagicSound();

                const selected = cards[Math.floor(Math.random() * cards.length)];
                const randomPhrase = phrases[Math.floor(Math.random() * phrases.length)];
                const randomSuit = suits[Math.floor(Math.random() * 4)];

                const front = selected.querySelector('.card-front');
                front.style.color = randomSuit.c;
                front.innerHTML = `<div class="suit top-left">${randomSuit.s}</div><div style="padding: 10px;">${randomPhrase}</div><div class="suit bottom-right">${randomSuit.s}</div>`;

                selected.classList.add('drawn');
                btn.disabled = false;
            }, 1000);
        }

        createDeck();
    </script>
</body>
</html>
